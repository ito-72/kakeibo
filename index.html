<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>記録しとこ</title>

  <link rel="stylesheet" href="style.css">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
  <link rel="manifest" href="/manifest.json">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" href="/icon-192.png">

<style>
/* --- 中略：あなたの CSS 全部そのまま --- */
</style>
</head>

<body>
  <canvas id="bgCanvas"></canvas>

  <div class="container">
    <h2>記録しとこ</h2>

    <label for="date">日付</label>
    <input type="date" id="date" />

    <label for="category">カテゴリー</label>
    <select id="category">
      <option value="food">食費</option>
      <option value="daily">日用品</option>
      <option value="gas">ガソリン</option>
      <option value="card">カード引き落とし</option>
      <option value="other">その他</option>
      <option value="relax">ほっこり</option>
      <option value="zarame">ざらめ</option>
      <option value="atsushi">篤志外食</option>
    </select>

    <div class="suggestions" id="suggestions"></div>

    <label for="item">内容</label>
    <input type="text" id="item" placeholder="例：お米" />

    <label for="price">金額</label>
    <input type="number" id="price" inputmode="numeric" pattern="[0-9]*" placeholder="例：500" />

    <!-- クレジット -->
    <label for="credit" style="display: flex; align-items: center; gap: 0.5rem; margin-top: 1rem; font-weight: bold;">
      <input type="checkbox" id="credit" style="
        appearance: none;
        width: 1.2rem;
        height: 1.2rem;
        border: 2px solid #ffa94d;
        border-radius: 6px;
        display: grid;
        place-content: center;
        cursor: pointer;
        background-color: #fff;
      ">
      <span style="user-select: none;">クレジット</span>
    </label>

    <!-- ★追加：千尋立て替え -->
    <label for="chihiro_flag" style="display: flex; align-items: center; gap: 0.5rem; margin-top: 1rem; font-weight: bold;">
      <input type="checkbox" id="chihiro_flag" style="
        appearance: none;
        width: 1.2rem;
        height: 1.2rem;
        border: 2px solid #ffa94d;
        border-radius: 6px;
        display: grid;
        place-content: center;
        cursor: pointer;
        background-color: #fff;
      ">
      <span style="user-select: none;">千尋立て替え</span>
    </label>

    <button id="submit">登録する</button>
  </div>

  <div class="toast" id="toast"></div>

<script>
/* --- カテゴリ別サジェスト処理（あなたのコードそのまま） --- */

document.getElementById("submit").addEventListener("click", async () => {
  const data = {
    category: document.getElementById("category").value,
    date: document.getElementById("date").value,
    item: document.getElementById("item").value,
    price: document.getElementById("price").value,
    credit: document.getElementById("credit").checked ? "〇" : "",
    chihiro_flag: document.getElementById("chihiro_flag").checked ? "〇" : ""  // ★追加
  };

  try {
    const response = await fetch("/api/saveData.js", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const result = await response.json();
    showToast(result.message || "登録しました！");

    document.getElementById("item").value = "";
    document.getElementById("price").value = "";
    document.getElementById("credit").checked = false;
    document.getElementById("chihiro_flag").checked = false;  // ★初期化

  } catch (error) {
    console.error("送信エラー:", error);
    showToast("送信に失敗しました。");
  }
});
</script>
</body>
</html>
